/*!
 * vue-circle-slider v0.1.0 
 * (c) 2019 
 * Released under the undefined License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):(e=e||self,t(e.VueCircleSlider={}))}(this,function(e){"use strict";function t(e,t,i,n,r,s,u,o,h,a){"boolean"!=typeof u&&(h=o,o=u,u=!1);var l="function"==typeof i?i.options:i;e&&e.render&&(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),n&&(l._scopeId=n);var d;if(s?(d=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,h(e)),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=d):t&&(d=u?function(){t.call(this,a(this.$root.$options.shadowRoot))}:function(e){t.call(this,o(e))}),d)if(l.functional){var c=l.render;l.render=function(e,t){return d.call(t),c(e,t)}}else{var p=l.beforeCreate;l.beforeCreate=p?[].concat(p,d):[d]}return i}function i(e){e.component("circle-slider",h)}var n={name:"CircleSlider",created:function(){var e=this;this.stepsCount=1+(this.max-this.min)/this.stepSize,this.steps=Array.from({length:this.stepsCount},function(t,i){return e.min+i*e.stepSize}),this.defineInitialCurrentStepIndex(),this.angle=this.cpAngleValue,this.currentStepValue=this.cpCurrentStep;var t=Math.max(this.cpMainCircleStrokeWidth,this.cpPathStrokeWidth);this.radius=this.side/2-Math.max(t,2*this.cpKnobRadius)/2,this.updateFromPropValue(this.value)},mounted:function(){this.containerElement=this.$refs._svg,this.sliderTolerance=this.radius/2,this.setNewPosition({x:0,y:0})},props:{startAngleOffset:{type:Number,required:!1,default:function(){return 0}},value:{type:Number,required:!1,default:0},side:{type:Number,required:!1,default:100},stepSize:{type:Number,required:!1,default:1},min:{type:Number,required:!1,default:0},max:{type:Number,required:!1,default:100},circleColor:{type:String,required:!1,default:"#334860"},progressColor:{type:String,required:!1,default:"#00be7e"},knobColor:{type:String,required:!1,default:"#00be7e"},knobRadius:{type:Number,required:!1,default:null},knobRadiusRel:{type:Number,required:!1,default:7},circleWidth:{type:Number,required:!1,default:null},circleWidthRel:{type:Number,required:!1,default:20},progressWidth:{type:Number,required:!1,default:null},progressWidthRel:{type:Number,required:!1,default:10}},data:function(){return{steps:null,stepsCount:null,radius:0,angle:0,currentStepValue:0,mousePressed:!1,mousemoveTicks:0,currentStepIndex:0,length:0,sliderTolerance:0,relativeX:0,relativeY:0}},computed:{cpStepsLength:function(){return this.steps.length-1},cpCenter:function(){return this.side/2},cpAngle:function(){return this.angle+Math.PI/2},cpMainCircleStrokeWidth:function(){return this.circleWidth||this.side/2/this.circleWidthRel},cpPathDirection:function(){return this.cpAngle<1.5*Math.PI?0:1},cpPathX:function(){return this.cpCenter+this.radius*Math.cos(this.cpAngle)},cpPathY:function(){return this.cpCenter+this.radius*Math.sin(this.cpAngle)},cpPathStrokeWidth:function(){return this.progressWidth||this.side/2/this.progressWidthRel},cpKnobRadius:function(){return this.knobRadius||this.side/2/this.knobRadiusRel},cpPathD:function(){var e=[];return e.push("M"+this.cpCenter),e.push(this.cpCenter+this.radius),e.push("A"),e.push(this.radius),e.push(this.radius),e.push(0),e.push(this.cpPathDirection),e.push(1),e.push(this.cpPathX),e.push(this.cpPathY),e.join(" ")},cpAngleUnit:function(){return(2*Math.PI-this.startAngleOffset)/this.cpStepsLength},cpAngleValue:function(){return Math.min(this.startAngleOffset+this.cpAngleUnit*this.currentStepIndex,2*Math.PI-Number.EPSILON)-1e-5},cpCurrentStep:function(){return this.steps[this.currentStepIndex]},cpSliderAngle:function(){return(Math.atan2(this.relativeY-this.cpCenter,this.relativeX-this.cpCenter)+3*Math.PI/2)%(2*Math.PI)},cpIsTouchWithinSliderRange:function(){var e=Math.sqrt(Math.pow(Math.abs(this.relativeX-this.cpCenter),2)+Math.pow(Math.abs(this.relativeY-this.cpCenter),2));return Math.abs(e-this.radius)<=this.sliderTolerance}},methods:{fitToStep:function(e){return Math.round(e/this.stepSize)*this.stepSize},handleClick:function(e){if(this.setNewPosition(e),this.cpIsTouchWithinSliderRange){var t=this.cpSliderAngle;this.animateSlider(this.angle,t)}},handleMouseDown:function(e){e.preventDefault(),this.mousePressed=!0,window.addEventListener("mousemove",this.handleWindowMouseMove),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp:function(e){e.preventDefault(),this.mousePressed=!1,window.removeEventListener("mousemove",this.handleWindowMouseMove),window.removeEventListener("mouseup",this.handleMouseUp),this.mousemoveTicks=0},handleWindowMouseMove:function(e){if(e.preventDefault(),this.mousemoveTicks<5)return void this.mousemoveTicks++;this.setNewPosition(e),this.updateSlider()},handleTouchMove:function(e){if(this.$emit("touchmove"),e.targetTouches.length>1||e.changedTouches.length>1||e.touches.length>1)return!0;var t=e.targetTouches.item(e.targetTouches.length-1);this.setNewPosition(t),this.cpIsTouchWithinSliderRange&&(e.preventDefault(),this.updateSlider())},updateAngle:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.updateCurrentStepFromAngle(e),this.angle=this.cpAngleValue,this.currentStepValue=this.cpCurrentStep,t&&this.$emit("input",this.currentStepValue)},updateFromPropValue:function(e){var t=this.fitToStep(e);this.updateCurrentStepFromValue(t),this.angle=this.cpAngleValue,this.currentStepValue=t,this.$emit("input",this.currentStepValue)},updateSlider:function(){var e=this.cpSliderAngle;Math.abs(e-this.angle)<Math.PI&&this.updateAngle(e)},animateSlider:function(e,t){var i=this,n=e<t?1:-1,r=n*this.cpAngleUnit*2,s=function(){if(Math.abs(t-e)<Math.abs(2*r))i.updateAngle(t,!0);else{var n=e+r;i.updateAngle(n,!1),i.animateSlider(n,t)}};window.requestAnimationFrame(s)},defineInitialCurrentStepIndex:function(){for(var e in this.steps)if(this.steps[e]===this.value){this.currentStepIndex=e;break}},updateCurrentStepFromValue:function(e){for(var t=0;t<this.cpStepsLength;t++)if(e<=this.steps[t])return void(this.currentStepIndex=t);this.currentStepIndex=this.cpStepsLength},updateCurrentStepFromAngle:function(e){var t=Math.round((e-this.startAngleOffset)/this.cpAngleUnit);this.currentStepIndex=Math.min(Math.max(t,0),this.cpStepsLength)},setNewPosition:function(e){var t=this.containerElement.getBoundingClientRect();this.relativeX=e.clientX-t.left,this.relativeY=e.clientY-t.top}},watch:{value:function(e){e!==this.currentStepValue&&this.updateFromPropValue(e)}}},r=t;const s=n;var u=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("svg",{ref:"_svg",attrs:{width:e.side+"px",height:e.side+"px",viewBox:"0 0 "+e.side+" "+e.side},on:{touchmove:e.handleTouchMove,click:e.handleClick,mousedown:e.handleMouseDown,mouseup:e.handleMouseUp}},[i("g",[i("circle",{attrs:{stroke:e.circleColor,fill:"none","stroke-width":e.cpMainCircleStrokeWidth,cx:e.cpCenter,cy:e.cpCenter,r:e.radius}}),e._v(" "),i("path",{attrs:{stroke:e.progressColor,fill:"none","stroke-width":e.cpPathStrokeWidth,d:e.cpPathD}}),e._v(" "),i("circle",{attrs:{fill:e.knobColor,r:e.cpKnobRadius,cx:e.cpPathX,cy:e.cpPathY}})])])])},o=[];var h=r({render:u,staticRenderFns:o},void 0,s,void 0,!1,void 0,void 0,void 0),a={version:"0.1.0",install:i},l=null;"undefined"!=typeof window?l=window.Vue:"undefined"!=typeof global&&(l=global.Vue),l&&l.use(a),e.CircleSlider=h,e.default=a,e.install=i,Object.defineProperty(e,"__esModule",{value:!0})});